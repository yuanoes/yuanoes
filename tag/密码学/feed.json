{
    "version": "https://jsonfeed.org/version/1",
    "title": "雨落新痕のblog • All posts by \"密码学\" tag",
    "description": "",
    "home_page_url": "https://mashiro.zone",
    "items": [
        {
            "id": "https://mashiro.zone/mimaxuepy/",
            "url": "https://mashiro.zone/mimaxuepy/",
            "title": "密码学加密实现",
            "date_published": "2021-03-03T08:53:52.000Z",
            "content_html": "<h2 id=\"仿射密码\"><a class=\"anchor\" href=\"#仿射密码\">#</a> 仿射密码</h2>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token string\">\"n\"</span>  <span class=\"token comment\"># 明文</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>a <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 将明文转换为列表形式</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>k1 <span class=\"token operator\">=</span> <span class=\"token number\">17</span>  <span class=\"token comment\"># 密钥 k1 与 26 互素的数</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>k2 <span class=\"token operator\">=</span> <span class=\"token number\">9</span>  <span class=\"token comment\"># 偏移量</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 将明文字符串转化为 Acsll 码然后将 0-a，25-z 对应</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">tihuan</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    temp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span> a<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>islower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            temp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">97</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            temp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">65</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">return</span> temp</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># 加密函数</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">encryption</span><span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">,</span> k1<span class=\"token punctuation\">,</span> k2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    c <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        c<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">*</span>k1<span class=\"token operator\">+</span>k2<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">26</span><span class=\"token operator\">+</span><span class=\"token number\">97</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">return</span> c</pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>temp <span class=\"token operator\">=</span> tihuan<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>c <span class=\"token operator\">=</span> encryption<span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">,</span> k1<span class=\"token punctuation\">,</span> k2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>c1 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    c1 <span class=\"token operator\">=</span> c1<span class=\"token operator\">+</span>c<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 将列表转化为字符串</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c1<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"维吉尼亚密码\"><a class=\"anchor\" href=\"#维吉尼亚密码\">#</a> 维吉尼亚密码</h2>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> math</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token string\">\"appliedcryptosystem\"</span>  <span class=\"token comment\"># 明文</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>a <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>k <span class=\"token operator\">=</span> <span class=\"token string\">\"cipher\"</span>  <span class=\"token comment\"># 密钥</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>b <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 确定分组数</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    x <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token operator\">//</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    x <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># Ascll</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">tihuan</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    temp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">if</span> a<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>islower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            temp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">97</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            temp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">65</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">return</span> temp</pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\"># 加密</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">encryption</span><span class=\"token punctuation\">(</span>tempm<span class=\"token punctuation\">,</span> tempk<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    c <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    z <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    n <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">if</span> x <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 如果组数为 0</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            c<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>tempm<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">+</span>tempk<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">26</span><span class=\"token operator\">+</span><span class=\"token number\">97</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                c<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>tempm<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token operator\">+</span>tempk<span class=\"token punctuation\">[</span>j <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">26</span><span class=\"token operator\">+</span><span class=\"token number\">97</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            z <span class=\"token operator\">=</span> n</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            n <span class=\"token operator\">+=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 我是 sb 能用常量不要用变量</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">for</span> d <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">*</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            c<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>tempm<span class=\"token punctuation\">[</span>d<span class=\"token punctuation\">]</span><span class=\"token operator\">+</span>tempk<span class=\"token punctuation\">[</span>d <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">26</span><span class=\"token operator\">+</span><span class=\"token number\">97</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">return</span> c</pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>tempm <span class=\"token operator\">=</span> tihuan<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>tempk <span class=\"token operator\">=</span> tihuan<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>c <span class=\"token operator\">=</span> encryption<span class=\"token punctuation\">(</span>tempm<span class=\"token punctuation\">,</span> tempk<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>c1 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    c1 <span class=\"token operator\">=</span> c1<span class=\"token operator\">+</span>c<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c1<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"hill密码\"><a class=\"anchor\" href=\"#hill密码\">#</a> hill 密码</h2>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token string\">'se'</span>  <span class=\"token comment\"># 明文</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 密钥 LCTFXZUHR</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>num_m <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>temp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>count <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> m<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 将明文分为三个一组</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    temp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">if</span> count <span class=\"token operator\">%</span> <span class=\"token number\">3</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        num_m<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        temp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    count <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>mat_m <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>np<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>T <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> num_m<span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 将明文分组转换为向量形式</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>mat_c <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>a <span class=\"token operator\">*</span> i <span class=\"token operator\">%</span> <span class=\"token number\">26</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> mat_m<span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 得到密文分组的向量形式</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>num_c <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>temp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> mat_c<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 将密文向量转换为列表形式，且合并到一个列表</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    temp <span class=\"token operator\">=</span> i<span class=\"token punctuation\">.</span>tolist<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        num_c<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> num_c<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 连接成字符串，输出密文</span></pre></td></tr></table></figure>",
            "tags": [
                "密码学"
            ]
        },
        {
            "id": "https://mashiro.zone/informationsafety/njuptnotes/notes/mimaxue/",
            "url": "https://mashiro.zone/informationsafety/njuptnotes/notes/mimaxue/",
            "title": "密码学",
            "date_published": "2021-02-26T00:07:17.000Z",
            "content_html": "<p><a id=\"more\"></a></p>\n<h3 id=\"近代密码时期\"><a class=\"anchor\" href=\"#近代密码时期\">#</a> 近代密码时期</h3>\n<p>揭秘密码战</p>\n<h3 id=\"现代密码时期\"><a class=\"anchor\" href=\"#现代密码时期\">#</a> 现代密码时期</h3>\n<p>香农论文将信息论引入密码学技术研究</p>\n<h3 id=\"加密体制的要素\"><a class=\"anchor\" href=\"#加密体制的要素\">#</a> 加密体制的要素</h3>\n<p>l<strong> 明文</strong>：发送方将要发送的消息</p>\n<p>l<strong> 密文</strong>：明文被变换成看似无意义的随机消息</p>\n<p>l<strong> 加密</strong>：明文变换成密文的过程称为加密</p>\n<p>l<strong> 解密</strong>：密文恢复出原明文的过程称为解密</p>\n<p>l<strong> 加密算法</strong>：对明文进行加密时所采用的一组规则</p>\n<p>l<strong> 解密算法</strong>：对密文进行解密时所采用的一组规则</p>\n<p>l** 加密和解密算法的操作通常都是在一组密钥控制下进行的，分别称为 加密密钥和解密密钥</p>\n<p>明文 m</p>\n<p>密文 c</p>\n<p>加密密钥 k1</p>\n<p>加密 Enc (m,k1)</p>\n<p>解密密钥 k2</p>\n<p>解密 Dec (c,k2)</p>\n<p>Dec()</p>\n<p>加密算法一般是公开的</p>\n<p>密钥管理</p>\n<p>对称密码：k1=k2，或密钥间有简单关系，密钥必须保密，用户共享密钥</p>\n<p>非对称:k1 已知的情况下，得到 k2 困难的，不同用户享有自己的公私钥对</p>\n<p>密码分析：社工手段，穷举密钥空间</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/yuanoes/imagehost@main/pic/image-20210226090017827.png\" alt=\"image-20210226090017827\" /></p>\n<p>安全性：什么样子的密码体制是安全的？</p>\n<p>理论安全性：即使攻击者有无限的资源，破译密文也是不可行的。攻击者无论有没有获得密文，对攻击者而言没用。</p>\n<p>密钥长度大于等于明文长度：不适用</p>\n<p>攻击者在一定时间范围内无法破解密码，密码系统就是有效的</p>\n<p>攻击者</p>\n<ul>\n<li>唯明文攻击 ：被动攻击的攻击者</li>\n<li>已知明文攻击： 获得明文密文</li>\n<li>选择性明文攻击 ：获得加密机</li>\n<li>选择密文攻击 ：获得解密机</li>\n</ul>\n<p>安全目标</p>\n<ul>\n<li>\n<p>有密文不能得到明文，就称密码系统是安全的</p>\n</li>\n<li>\n<p>不希望能够获得 m 的一些信息</p>\n</li>\n</ul>\n<p>定义：不可区分性</p>\n<p>加密系统交互</p>\n<p>猜测 cb 是 m0，还是 m1 的密文与加密系统选择一致，攻击者成功。猜对概率为 1/2，攻击者知晓密文概率也不变</p>\n<p>reduction, 复杂性理论</p>\n<h3 id=\"古典密码技术\"><a class=\"anchor\" href=\"#古典密码技术\">#</a> 古典密码技术</h3>\n<ul>\n<li>定义和分类</li>\n<li>代换密码：将明文元素（字符、比特）映射成密文</li>\n<li>置换密码：将明文元素相对位置调整</li>\n</ul>\n<p>映射关系：</p>\n<p>单射</p>\n<blockquote>\n<p>周期置换 n: 每次处理的消息长度</p>\n<p>先按周期长度对明文分组，利用置换密钥进行加密变换</p>\n</blockquote>\n<ul>\n<li>输入输出，注意轮换规则</li>\n</ul>\n<p>（1，3）（2，5，4，6）</p>\n<p>是指，1-&gt;3-&gt;1，2-&gt;5-&gt;4-&gt;6-&gt;2</p>\n<p>解密：就是输入改为输出，输出改为输入，为 F 逆</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/yuanoes/imagehost@main/pic/image-20210302140818388.png\" alt=\"image-20210302140818388\" /></p>\n<p>例如：输入密文<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><msub><mi>m</mi><mn>3</mn></msub><msub><mi>m</mi><mn>4</mn></msub><msub><mi>m</mi><mn>2</mn></msub><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">c=m_3m_4m_2m_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>按照：逆规则解密</p>\n<p>m=<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub><msub><mi>m</mi><mn>2</mn></msub><msub><mi>m</mi><mn>3</mn></msub><msub><mi>m</mi><mn>4</mn></msub></mrow><annotation encoding=\"application/x-tex\">m_1m_2m_3m_4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<h4 id=\"置换密码\"><a class=\"anchor\" href=\"#置换密码\">#</a> 置换密码</h4>\n<p>代换密码要先建立一个代换表，密钥即代换表，可以有多个代换表</p>\n<p><em>例如：凯撒密码：a-z 0-25</em></p>\n<p>明文加 3mod26 得到密文非负</p>\n<p>最后这里把 3 做为密钥 k 为一个变量进行加密</p>\n<p>k 的密钥空间 26，密钥空间过小，暴力破解。</p>\n<p>仿射密码</p>\n<p (k1，k2)|=\"\" k1，k2∈Z26，gcd(k1，26)=\"1\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo></mrow><annotation encoding=\"application/x-tex\">K=</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span></span></span></span></p>\n<p>对任意 m∈M，c∈C，k = (k1，k2)∈K，定义加密变换和相应的解密变换为：<br />\nc = ek (m) = k1 m +k2 (mod 26)<br />\nm = dk (c) = k1^－1 (c－k2) (mod 26)</p>\n<p>当 k1=1 时为一般的凯撒密码</p>\n<p>解密则为解同余方程</p>\n<p>k1 与 26 互素的个数为 26 的欧拉函数为 12</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/yuanoes/imagehost@main/pic/image-20210302151328701.png\" alt=\"image-20210302151328701\" /></p>\n<p>所以仿射密码密钥的空间量为</p>\n<p>12*26=312</p>\n<p>密钥空间量也很小</p>\n<p>如果把代替表随机匹配</p>\n<p>则有 26！种可以有效的避免暴力破解</p>\n<p>但是如果密文数够多则可以统计出代替表</p>\n<ul>\n<li>\n<p>多表代换</p>\n<p>维吉尼亚密码：</p>\n<p>先用 n 进行分组</p>\n<p>密钥长度与 n 的长度相同</p>\n</li>\n</ul>\n<p>该密码体制有一个参数 n。在加解密时，按 n 个字母一组进行变换。<br />\n加密变换定义如下：<br />\n设密钥 k=(k1,k2,…,kn), 明文 m=(m1,m2,…,mn):<br />\ne(k, m)=(c1,c2,…,cn),<br />\n 其中 ci=(mi + ki)(mod26)，i =1,2,…,n<br />\n 对密文 c=(c1,c2,…,cn),  解密变换为：<br />\nd(k, c)=(m1,m2,…,mn),<br />\n 其中 mi=(ci －ki)(mod26)，i =1,2,…,n</p>\n<p>就是每个移位不一样</p>\n<p>Hill 密码</p>\n<p>K 是有 0-25 组成的可逆矩阵就</p>\n<p>行列式的值与 26 互素</p>\n<p>2 0</p>\n<p>0 1</p>\n<p>逆矩阵求解</p>\n<p>算法的密钥 K={Z26 上的 n<em>n 可逆矩阵}，明文 M 与密文 C 均为 n 维向量，加密和解密变换分别为：<br />\nC=K</em>M(mod 26);   M=K-1*C(mod 26)<br />\n 其中，K–1 为 K 在模 26 上的逆矩阵：KK–1 =K–1K=I (mod 26)  这里 I 为单位矩阵。</p>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/yuanoes/imagehost@main/pic/image-20210302160433524.png\" alt=\"image-20210302160433524\" /></p>\n",
            "tags": [
                "密码学"
            ]
        }
    ]
}